<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Finals Loadout Randomizer</title>
        <style>
        :root {
            --lt-color-gray-100: #f8f9fc;
            --lt-color-gray-200: #f1f3f9;
            --lt-color-gray-300: #dee3ed;
            --lt-color-gray-400: #c2c9d6;
            --lt-color-gray-500: #8f96a3;
            --lt-color-gray-600: #5e636e;
            --lt-color-gray-700: #2f3237;
            --lt-color-gray-800: #1d1e20;
            --lt-color-gray-900: #111213;
            --lt-color-white: #fff;
            --lt-color-black: #111213;
            --lt-color-transparent: rgba(255, 255, 255, 0);
            --lt-color-background-light: var(--lt-color-gray-100);
            --lt-color-background-default: var(--lt-color-gray-200);
            --lt-color-background-dark: var(--lt-color-gray-300);
            --lt-color-border-light: var(--lt-color-gray-200);
            --lt-color-border-default: var(--lt-color-gray-300);
            --lt-color-border-dark: var(--lt-color-gray-400);
            --lt-color-text-very-light: var(--lt-color-gray-500);
            --lt-color-text-light: var(--lt-color-gray-600);
            --lt-color-text-default: var(--lt-color-gray-700);
            --lt-color-text-dark: var(--lt-color-gray-800);
            --lt-shadowDefault: 0 2px 6px -1px rgba(0, 0, 0, 0.16), 0 1px 4px -1px rgba(0, 0, 0, 0.04);
            --lt-shadowActive: 0 0 8px -2px rgba(0, 0, 0, 0.1), 0 6px 20px -3px rgba(0, 0, 0, 0.2);
            
            color-scheme: dark;
            --lt-color-white: #111213;
            --lt-color-black: #fff;
            --lt-color-transparent: rgba(17, 18, 19, 0);
            --lt-color-background-light: var(--lt-color-gray-800);
            --lt-color-background-default: var(--lt-color-gray-700);
            --lt-color-background-dark: var(--lt-color-gray-600);
            --lt-color-border-light: var(--lt-color-gray-800);
            --lt-color-border-default: var(--lt-color-gray-700);
            --lt-color-border-dark: var(--lt-color-gray-600);
            --lt-color-text-very-light: var(--lt-color-gray-400);
            --lt-color-text-light: var(--lt-color-gray-300);
            --lt-color-text-default: var(--lt-color-gray-200);
            --lt-color-text-dark: var(--lt-color-gray-100);
            --lt-color-overlay: var(--lt-color-gray-700);
            --lt-color-overlay-default: var(--lt-color-gray-700);
            --lt-color-overlay-dark: var(--lt-color-gray-800);
            --lt-color-overlay-transparent: rgba(0, 0, 0, 0.6);
            --lt-shadow-website-overlay: 0 0 0 1px var(--lt-color-gray-600);
            --lt-shadowDefault: 0 0 0 1px var(--lt-color-gray-700);
            --lt-shadowActive: 0 0 0 1px var(--lt-color-gray-600);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--lt-color-background-light);
            color: var(--lt-color-text-dark);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        h1 {
            text-align: center;
            margin-bottom: 32px;
            color: #ff6b35;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .randomizer-section {
            background: var(--lt-color-background-default);
            border: 1px solid var(--lt-color-border-default);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--lt-shadowDefault);
        }

        .controls {
            text-align: center;
            margin-bottom: 24px;
        }

        .btn {
            background: #ff6b35;
            color: #ffffff;
            border: none;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 8px;
            margin: 0 8px;
            transition: all 0.2s ease;
            box-shadow: var(--lt-shadowDefault);
        }

        .btn:hover {
            background: #e55a2b;
            box-shadow: var(--lt-shadowActive);
            transform: translateY(-1px);
        }

        .result {
            background: var(--lt-color-background-dark);
            border: 2px solid #ff6b35;
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            box-shadow: var(--lt-shadowDefault);
        }

        .result h3 {
            color: #ff6b35;
            margin-bottom: 12px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .loadout-url {
            background: var(--lt-color-background-light);
            border: 1px solid var(--lt-color-border-default);
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
            word-break: break-all;
            color: var(--lt-color-text-light);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .build-section {
            background: var(--lt-color-background-default);
            border: 1px solid var(--lt-color-border-default);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--lt-shadowDefault);
        }

        .build-title {
            color: #ff6b35;
            text-transform: uppercase;
            font-weight: 700;
            margin-bottom: 16px;
            text-align: center;
            font-size: 1.4rem;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--lt-color-border-dark);
        }

        .category {
            margin-bottom: 20px;
        }

        .category-title {
            color: var(--lt-color-text-default);
            text-transform: uppercase;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 1px solid var(--lt-color-border-default);
        }

        .equipment-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px 12px;
            background: var(--lt-color-background-light);
            border: 1px solid var(--lt-color-border-light);
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .equipment-item:hover {
            background: var(--lt-color-background-dark);
            border-color: var(--lt-color-border-dark);
        }

        .equipment-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.2);
            accent-color: #ff6b35;
        }

        .equipment-item label {
            cursor: pointer;
            flex: 1;
            font-weight: 500;
            color: var(--lt-color-text-default);
        }

        .equipment-item input[type="checkbox"]:checked + label {
            color: #ff6b35;
            font-weight: 600;
        }

        .bulk-controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .bulk-btn {
            background: var(--lt-color-background-dark);
            color: var(--lt-color-text-default);
            border: 1px solid var(--lt-color-border-default);
            padding: 8px 16px;
            margin: 0 6px;
            cursor: pointer;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .bulk-btn:hover {
            background: var(--lt-color-background-dark);
            border-color: var(--lt-color-border-dark);
            color: var(--lt-color-text-dark);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>The Finals Loadout Randomizer</h1>
        
        <div class="randomizer-section">
            <div class="controls">
                <button class="btn" onclick="generateRandomLoadout()">Generate Random Loadout</button>
                <button class="btn" onclick="generateAllBuilds()">Generate All 3 Builds</button>
            </div>
            
            <div id="results"></div>
        </div>

        <div class="randomizer-section">
            <div class="bulk-controls">
                <button class="bulk-btn" onclick="selectAll()">Select All</button>
                <button class="bulk-btn" onclick="deselectAll()">Deselect All</button>
            </div>
            
            <div class="equipment-grid" id="equipmentGrid">
                <!-- Equipment toggles will be populated here -->
            </div>
        </div>
    </div>

    <script>
        let gameData = [];

        // Load data from data.json
        async function loadData() {
            try {
                const response = await fetch('data.json');
                gameData = await response.json();
                populateEquipmentToggles();
            } catch (error) {
                console.error('Error loading data:', error);
                alert('Error loading data.json. Please make sure the file exists and is properly formatted.');
            }
        }

        function isDefaultWeapon(weapon, buildId) {
            // Default starter weapons for each build
            const defaultWeapons = {
                'LI': ['XP'], // Light: XP-54
                'MD': ['AK'], // Medium: AKM  
                'HV': ['SL']  // Heavy: Sledgehammer
            };
            
            return defaultWeapons[buildId] && defaultWeapons[buildId].includes(weapon.id);
        }

        function populateEquipmentToggles() {
            const grid = document.getElementById('equipmentGrid');
            
            gameData.forEach(buildData => {
                const buildDiv = document.createElement('div');
                buildDiv.className = 'build-section';
                
                const buildTitle = document.createElement('div');
                buildTitle.className = 'build-title';
                buildTitle.textContent = buildData.build.name;
                buildDiv.appendChild(buildTitle);

                // Specializations
                if (buildData.specializations.length > 0) {
                    const specDiv = document.createElement('div');
                    specDiv.className = 'category';
                    const specTitle = document.createElement('div');
                    specTitle.className = 'category-title';
                    specTitle.textContent = 'Specializations';
                    specDiv.appendChild(specTitle);

                    buildData.specializations.forEach(spec => {
                        const item = createEquipmentToggle(spec.id, spec.name, true);
                        specDiv.appendChild(item);
                    });
                    buildDiv.appendChild(specDiv);
                }

                // Gadgets
                if (buildData.gadgets.length > 0) {
                    const gadgetDiv = document.createElement('div');
                    gadgetDiv.className = 'category';
                    const gadgetTitle = document.createElement('div');
                    gadgetTitle.className = 'category-title';
                    gadgetTitle.textContent = 'Gadgets';
                    gadgetDiv.appendChild(gadgetTitle);

                    buildData.gadgets.forEach(gadget => {
                        const item = createEquipmentToggle(gadget.id, gadget.name, gadget.value === 0);
                        gadgetDiv.appendChild(item);
                    });
                    buildDiv.appendChild(gadgetDiv);
                }

                // Weapons
                if (buildData.weapons.length > 0) {
                    const weaponDiv = document.createElement('div');
                    weaponDiv.className = 'category';
                    const weaponTitle = document.createElement('div');
                    weaponTitle.className = 'category-title';
                    weaponTitle.textContent = 'Weapons';
                    weaponDiv.appendChild(weaponTitle);

                    buildData.weapons.forEach(weapon => {
                        const item = createEquipmentToggle(weapon.id, weapon.name, weapon.value === 0);
                        weaponDiv.appendChild(item);
                    });
                    buildDiv.appendChild(weaponDiv);
                }

                grid.appendChild(buildDiv);
            });
        }

        function createEquipmentToggle(id, name, defaultChecked) {
            const item = document.createElement('div');
            item.className = 'equipment-item';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = id;
            checkbox.checked = defaultChecked;

            const label = document.createElement('label');
            label.htmlFor = id;
            label.textContent = name;

            item.appendChild(checkbox);
            item.appendChild(label);

            return item;
        }

        function getAvailableItems(buildData, category) {
            return buildData[category].filter(item => {
                const checkbox = document.getElementById(item.id);
                return checkbox && checkbox.checked;
            });
        }

        function getRandomItem(items) {
            if (items.length === 0) return null;
            return items[Math.floor(Math.random() * items.length)];
        }

        function generateRandomLoadout() {
            const availableBuilds = gameData.filter(buildData => {
                const buildCheckbox = document.getElementById(buildData.build.id);
                return !buildCheckbox || buildCheckbox.checked;
            });

            if (availableBuilds.length === 0) {
                alert('No builds available! Please select at least one build.');
                return;
            }

            const randomBuild = getRandomItem(availableBuilds);
            const loadout = generateLoadoutForBuild(randomBuild);
            
            displayResults([loadout]);
        }

        function generateAllBuilds() {
            const loadouts = [];
            
            gameData.forEach(buildData => {
                const buildCheckbox = document.getElementById(buildData.build.id);
                if (!buildCheckbox || buildCheckbox.checked) {
                    const loadout = generateLoadoutForBuild(buildData);
                    loadouts.push(loadout);
                }
            });

            if (loadouts.length === 0) {
                alert('No builds available! Please select at least one build.');
                return;
            }

            displayResults(loadouts);
        }

        function generateLoadoutForBuild(buildData) {
            const availableSpecs = getAvailableItems(buildData, 'specializations');
            const availableGadgets = getAvailableItems(buildData, 'gadgets');
            const availableWeapons = getAvailableItems(buildData, 'weapons');

            const randomSpec = getRandomItem(availableSpecs);
            const randomGadgets = [];
            const randomWeapon = getRandomItem(availableWeapons);

            // Select 3 random gadgets
            for (let i = 0; i < 3 && availableGadgets.length > 0; i++) {
                const gadget = getRandomItem(availableGadgets);
                if (gadget) {
                    randomGadgets.push(gadget);
                    // Remove selected gadget to avoid duplicates
                    const index = availableGadgets.indexOf(gadget);
                    availableGadgets.splice(index, 1);
                }
            }

            // Generate URL code
            let code = buildData.build.id;
            if (randomSpec) code += randomSpec.id;
            if (randomWeapon) code += randomWeapon.id;
            randomGadgets.forEach(gadget => code += gadget.id);

            // Pad with additional characters if needed (based on the pattern you showed)
            while (code.length < 14) {
                code += 'XX'; // Placeholder
            }

            return {
                build: buildData.build.name,
                specialization: randomSpec ? randomSpec.name : 'None available',
                weapon: randomWeapon ? randomWeapon.name : 'None available',
                gadgets: randomGadgets.map(g => g.name),
                code: code,
                url: `https://www.thefinals.me/-/${code}`
            };
        }

        function displayResults(loadouts) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            loadouts.forEach((loadout, index) => {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'result';

                resultDiv.innerHTML = `
                    <h3>${loadout.build} Build</h3>
                    <p><strong>Specialization:</strong> ${loadout.specialization}</p>
                    <p><strong>Weapon:</strong> ${loadout.weapon}</p>
                    <p><strong>Gadgets:</strong> ${loadout.gadgets.join(', ')}</p>
                    <div class="loadout-url">
                        <strong>URL:</strong> <a href="${loadout.url}" target="_blank" style="color: #ff6b35;">${loadout.url}</a>
                    </div>
                `;

                resultsDiv.appendChild(resultDiv);
            });
        }

        function selectAll() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = true);
        }

        function deselectAll() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
        }

        // Initialize when page loads
        window.addEventListener('load', loadData);
    </script>
</body>
</html>